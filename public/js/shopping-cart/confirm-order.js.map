{"version":3,"sources":["ConfirmOrder.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"confirm-order.js","sourcesContent":["/**\n * Required global object\n * - confirmOrder\n *     - current_currency_symbol\n *\n * File dependencies\n * - public/js/shopping-cart/shopping-cart.js\n */\nvar ConfirmOrder = {\n    cart_items: [],\n\n    shipping_fee: 10, // assume\n\n    init: function() {\n        ConfirmOrder.loadOrders(function() {\n            var order_list = $('#order-list');\n            var tmpl = _.template($('#order-list-tmpl').html());\n\n            order_list.append(tmpl({\n                orders: ConfirmOrder.cart_items,\n                currency: confirmOrder.current_currency_symbol\n            }));\n\n            var total_items_fee = _.pluck(ConfirmOrder.cart_items, \"total_price\").reduce(function(n1, n2) { return n1 + n2; });\n\n            $('#order-summary .total-items-fee').text(\"$\" + total_items_fee.toFixed(2));\n            $('#order-summary .shipping-fee').text(\"$\" + ConfirmOrder.shipping_fee.toFixed(2));\n            $('#order-summary .total-amount').text(\"$\" + (total_items_fee + ConfirmOrder.shipping_fee).toFixed(2));\n\n            $('.view-all-players', order_list).click(ConfirmOrder.onViewAllPlayers);\n        });\n    },\n\n    loadOrders: function(callback) {\n        ShoppingCart.cipa.getPlayersPerCartItem(function(response, textStatus, xhr) {\n            if (response.success) {\n                if (response.data.length > 0) {\n                    ConfirmOrder.cart_items = response.data;\n\n                    callback();\n                } else {\n                    $('#order-list').html('<div class=\"col-md-12\">Cart is empty</div>');\n                }\n            } else {\n                $('#order-list').html('<div class=\"col-md-12\">Failed to fetch your orders.</div>');\n            }\n        });\n    },\n\n    onViewAllPlayers: function() {\n        var cart_item_id = $(this).data('cart-item-id');\n        var tmpl = _.template($('#all-players-tmpl').html());\n\n        var cart_item = _.find(ConfirmOrder.cart_items, {cart_item_id: cart_item_id});\n        var all_player_sizes = _.sortBy(_.uniq(_.pluck(cart_item.players, 'size')));\n\n        bootbox.dialog({\n            title: \"All Players\",\n            message: tmpl({\n                players: cart_item.players,\n                all_player_sizes: all_player_sizes,\n                currency: confirmOrder.current_currency_symbol\n            }),\n            size: \"large\"\n        });\n    },\n};\n\n$(document).ready(ConfirmOrder.init);"]}